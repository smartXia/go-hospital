/*! 
 Build based on BAIDU 
 Time : 1716207707000 */
import{o as e,g as a,w as l,f as t,j as o,E as s,d as i,_ as r,a as p,c as u,b as n,N as d,O as c,F as m,df as v,t as f,R as g,k as B,I as b}from"./087AC4D233B64EB0index.5fcd1422.js";import{E as h}from"./087AC4D233B64EB0drawer.6a894563.js";import"./087AC4D233B64EB0overlay.1520877c.js";import{E as y}from"./087AC4D233B64EB0pagination.81705c9f.js";/* empty css                              *//* empty css                            */import{E as C,a as E}from"./087AC4D233B64EB0select.591b7648.js";import"./087AC4D233B64EB0scrollbar.b45aa0d9.js";/* empty css                               */import{E as _,a as A}from"./087AC4D233B64EB0table-column.de1f83f6.js";import"./087AC4D233B64EB0checkbox.2864820c.js";/* empty css                                */import{a as D,E as w}from"./087AC4D233B64EB0form-item.69b26929.js";/* empty css                               */import{g as j,d as x,f as I,a as V,u as k,c as T,b as S}from"./087AC4D233B64EB0api.a9a90911.js";import{t as U}from"./087AC4D233B64EB0stringFun.647a78e9.js";import{_ as G}from"./087AC4D233B64EB0warningBar.a4d9a0b0.js";import{E as q}from"./087AC4D233B64EB0upload.4d125e06.js";import"./087AC4D233B64EB0progress.a616ce78.js";import"./087AC4D233B64EB0index.71b3c6ca.js";import"./087AC4D233B64EB0isEqual.c192b418.js";import"./087AC4D233B64EB0_Uint8Array.72188c2c.js";import"./087AC4D233B64EB0index.d064f019.js";import"./087AC4D233B64EB0strings.84714f21.js";import"./087AC4D233B64EB0debounce.679d5750.js";import"./087AC4D233B64EB0_baseIteratee.bf25bc12.js";import"./087AC4D233B64EB0index.508774e7.js";import"./087AC4D233B64EB0castArray.ef7e3470.js";import"./087AC4D233B64EB0_initCloneObject.67d0c1fc.js";import"./087AC4D233B64EB0_baseClone.bd09a709.js";import"./087AC4D233B64EB0cloneDeep.1ed46a18.js";const O={__name:"exportExcel",props:{templateId:{type:String,required:!0},condition:{type:Object,default:()=>({})},limit:{type:Number,default:0},offset:{type:Number,default:0},order:{type:String,default:""}},setup(i){const r=i,p=async()=>{if(""===r.templateId)return void o.error("组件未设置模板ID");const e=JSON.parse(JSON.stringify(r.condition));r.limit&&(e.limit=r.limit),r.offset&&(e.offset=r.offset),r.order&&(e.order=r.order);const a=Object.entries(e).map((([e,a])=>"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a)))).join("&"),l="".concat("http://121.37.182.90:8888/api","/sysExportTemplate/exportExcel?templateID=").concat(r.templateId).concat(a?"&"+a:"");window.open(l,"_blank")};return(o,i)=>{const r=s;return e(),a(r,{type:"primary",icon:"download",onClick:p},{default:l((()=>[t("导出")])),_:1})}}},z={__name:"exportTemplate",props:{templateId:{type:String,required:!0}},setup(i){const r=i,p=async()=>{if(""===r.templateId)return void o.error("组件未设置模板ID");const e="".concat("http://121.37.182.90:8888/api","/sysExportTemplate/exportTemplate?templateID=").concat(r.templateId);window.open(e,"_blank")};return(o,i)=>{const r=s;return e(),a(r,{type:"primary",icon:"download",onClick:p},{default:l((()=>[t("下载模板")])),_:1})}}},P={__name:"importExcel",props:{templateId:{type:String,required:!0}},emits:["on-success"],setup(r,{emit:p}){const u=r,n=p,d="".concat("http://121.37.182.90:8888/api","/sysExportTemplate/importExcel?templateID=").concat(u.templateId),c=e=>{0===e.code?(o.success("导入成功"),n("on-success")):o.error(e.msg)};return(o,r)=>{const p=s,u=q;return e(),a(u,{action:d,"show-file-list":!1,"on-success":c,multiple:!1},{default:l((()=>[i(p,{type:"primary",icon:"upload"},{default:l((()=>[t("导入")])),_:1})])),_:1})}}},F={class:"gva-search-box"},N={class:"gva-table-box"},R={class:"gva-btn-list"},J={class:"gva-pagination"},H={class:"flex justify-between items-center"},K={class:"text-lg"},L=r(Object.assign({name:"Api"},{__name:"api",setup(r){const q=e=>{const a=M.value.filter((a=>a.value===e))[0];return a&&"".concat(a.label)},L=p([]),Q=p({path:"",apiGroup:"",method:"",description:""}),M=p([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),W=p(""),X=p({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),Y=p(1),Z=p(0),$=p(10),ee=p([]),ae=p({}),le=()=>{ae.value={}},te=()=>{Y.value=1,$.value=10,re()},oe=e=>{$.value=e,re()},se=e=>{Y.value=e,re()},ie=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),ae.value.orderKey=U(e),ae.value.desc="descending"===a),re()},re=async()=>{const e=await j({page:Y.value,pageSize:$.value,...ae.value});0===e.code&&(ee.value=e.data.list,Z.value=e.data.total,Y.value=e.data.page,$.value=e.data.pageSize)};re();const pe=e=>{L.value=e},ue=async()=>{g.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=L.value.map((e=>e.ID)),a=await x({ids:e});0===a.code&&(o({type:"success",message:a.msg}),ee.value.length===e.length&&Y.value>1&&Y.value--,re())}))},ne=async()=>{g.confirm("确定要刷新缓存吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await I();0===e.code&&o({type:"success",message:e.msg})}))},de=p(null),ce=p("新增Api"),me=p(!1),ve=e=>{switch(e){case"addApi":ce.value="新增Api";break;case"edit":ce.value="编辑Api"}W.value=e,me.value=!0},fe=()=>{de.value.resetFields(),Q.value={path:"",apiGroup:"",method:"",description:""},me.value=!1},ge=async()=>{de.value.validate((async e=>{if(e)switch(W.value){case"addApi":0===(await T(Q.value)).code&&o({type:"success",message:"添加成功",showClose:!0}),re(),fe();break;case"edit":0===(await k(Q.value)).code&&o({type:"success",message:"编辑成功",showClose:!0}),re(),fe();break;default:o({type:"error",message:"未知操作",showClose:!0})}}))};return(r,p)=>{const j=B,x=D,I=C,k=E,T=s,U=w,W=b,Be=_,be=A,he=y,ye=h;return e(),u("div",null,[n("div",F,[i(U,{ref:"searchForm",inline:!0,model:ae.value},{default:l((()=>[i(x,{label:"路径"},{default:l((()=>[i(j,{modelValue:ae.value.path,"onUpdate:modelValue":p[0]||(p[0]=e=>ae.value.path=e),placeholder:"路径"},null,8,["modelValue"])])),_:1}),i(x,{label:"描述"},{default:l((()=>[i(j,{modelValue:ae.value.description,"onUpdate:modelValue":p[1]||(p[1]=e=>ae.value.description=e),placeholder:"描述"},null,8,["modelValue"])])),_:1}),i(x,{label:"API组"},{default:l((()=>[i(j,{modelValue:ae.value.apiGroup,"onUpdate:modelValue":p[2]||(p[2]=e=>ae.value.apiGroup=e),placeholder:"api组"},null,8,["modelValue"])])),_:1}),i(x,{label:"请求"},{default:l((()=>[i(k,{modelValue:ae.value.method,"onUpdate:modelValue":p[3]||(p[3]=e=>ae.value.method=e),clearable:"",placeholder:"请选择"},{default:l((()=>[(e(!0),u(d,null,c(M.value,(l=>(e(),a(I,{key:l.value,label:"".concat(l.label,"(").concat(l.value,")"),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(x,null,{default:l((()=>[i(T,{type:"primary",icon:"search",onClick:te},{default:l((()=>[t("查询")])),_:1}),i(T,{icon:"refresh",onClick:le},{default:l((()=>[t("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),n("div",N,[n("div",R,[i(T,{type:"primary",icon:"plus",onClick:p[4]||(p[4]=e=>ve("addApi"))},{default:l((()=>[t("新增")])),_:1}),i(W,{class:"cursor-pointer"},{default:l((()=>[i(m(v))])),_:1}),i(T,{icon:"delete",disabled:!L.value.length,onClick:ue},{default:l((()=>[t("删除")])),_:1},8,["disabled"]),i(T,{icon:"Refresh",onClick:ne},{default:l((()=>[t("刷新缓存")])),_:1}),i(z,{"template-id":"api"}),i(O,{"template-id":"api",limit:9999}),i(P,{"template-id":"api",onOnSuccess:re})]),i(be,{data:ee.value,onSortChange:ie,onSelectionChange:pe},{default:l((()=>[i(Be,{type:"selection",width:"55"}),i(Be,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),i(Be,{align:"left",label:"API路径","min-width":"150",prop:"path",sortable:"custom"}),i(Be,{align:"left",label:"API分组","min-width":"150",prop:"apiGroup",sortable:"custom"}),i(Be,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),i(Be,{align:"left",label:"请求","min-width":"150",prop:"method",sortable:"custom"},{default:l((e=>[n("div",null,f(e.row.method)+" / "+f(q(e.row.method)),1)])),_:1}),i(Be,{align:"left",fixed:"right",label:"操作",width:"200"},{default:l((e=>[i(T,{icon:"edit",type:"primary",link:"",onClick:a=>(async e=>{const a=await V({id:e.ID});Q.value=a.data.api,ve("edit")})(e.row)},{default:l((()=>[t("编辑")])),_:2},1032,["onClick"]),i(T,{icon:"delete",type:"primary",link:"",onClick:a=>(async e=>{g.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await S(e)).code&&(o({type:"success",message:"删除成功!"}),1===ee.value.length&&Y.value>1&&Y.value--,re())}))})(e.row)},{default:l((()=>[t("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),n("div",J,[i(he,{"current-page":Y.value,"page-size":$.value,"page-sizes":[10,30,50,100],total:Z.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:se,onSizeChange:oe},null,8,["current-page","page-size","total"])])]),i(ye,{modelValue:me.value,"onUpdate:modelValue":p[9]||(p[9]=e=>me.value=e),size:"60%","before-close":fe,"show-close":!1},{header:l((()=>[n("div",H,[n("span",K,f(ce.value),1),n("div",null,[i(T,{onClick:fe},{default:l((()=>[t("取 消")])),_:1}),i(T,{type:"primary",onClick:ge},{default:l((()=>[t("确 定")])),_:1})])])])),default:l((()=>[i(G,{title:"新增API，需要在角色管理内配置权限才可使用"}),i(U,{ref_key:"apiForm",ref:de,model:Q.value,rules:X.value,"label-width":"80px"},{default:l((()=>[i(x,{label:"路径",prop:"path"},{default:l((()=>[i(j,{modelValue:Q.value.path,"onUpdate:modelValue":p[5]||(p[5]=e=>Q.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(x,{label:"请求",prop:"method"},{default:l((()=>[i(k,{modelValue:Q.value.method,"onUpdate:modelValue":p[6]||(p[6]=e=>Q.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:l((()=>[(e(!0),u(d,null,c(M.value,(l=>(e(),a(I,{key:l.value,label:"".concat(l.label,"(").concat(l.value,")"),value:l.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),i(x,{label:"api分组",prop:"apiGroup"},{default:l((()=>[i(j,{modelValue:Q.value.apiGroup,"onUpdate:modelValue":p[7]||(p[7]=e=>Q.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(x,{label:"api简介",prop:"description"},{default:l((()=>[i(j,{modelValue:Q.value.description,"onUpdate:modelValue":p[8]||(p[8]=e=>Q.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-4388c1f0"]]);export{L as default};
