/*! 
 Build based on BAIDU 
 Time : 1716207707000 */
import{_ as e,dd as a,a as l,d0 as s,X as t,P as i,o,c as u,G as r,F as n,g as d,w as c,d as p,e as m,b as v,cU as g,f as y,d3 as k,N as f,O as C,de as B,t as E,R as j,j as _,I as x,k as b,E as h}from"./087AC4D233B64EB0index.5fcd1422.js";import{E as w}from"./087AC4D233B64EB0drawer.6a894563.js";import"./087AC4D233B64EB0overlay.1520877c.js";import{E as A}from"./087AC4D233B64EB0pagination.81705c9f.js";/* empty css                              *//* empty css                            */import"./087AC4D233B64EB0select.591b7648.js";import"./087AC4D233B64EB0scrollbar.b45aa0d9.js";/* empty css                               */import{E as D}from"./087AC4D233B64EB0image-viewer.63f45130.js";/* empty css                               */import{a as V,i as z,_ as S,U,e as T,g as I}from"./087AC4D233B64EB0common.a30badd1.js";import{_ as O}from"./087AC4D233B64EB0warningBar.a4d9a0b0.js";const P=["src"],F={key:1,class:"multiple-img"},M=["onClick"],N=["src"],G=["onClick"],R={key:0,class:"add-image"},X={class:"gva-btn-list"},q={class:"media"},H={class:"header-img-box-list"},J=["onClick"],K=["src"],L={key:2,class:"header-img-box-list"},Q=["onClick"],W=e({__name:"selectImage",props:a({multiple:{type:Boolean,default:!1},fileType:{type:String,default:""},maxUpdateCount:{type:Number,default:0}},{modelValue:{type:[String,Array]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const a=l(""),W=l(""),Y=l({}),Z=l(1),$=l(0),ee=l(20),ae=s(e,"modelValue"),le=e,se=l([]);t((()=>{le.multiple&&(se.value=ae.value)}));const te=e=>{se.value.splice(e,1),ae.value=se.value},ie=e=>{ee.value=e,pe()},oe=e=>{Z.value=e,pe()},ue=l(!1),re=l([]),ne={image:["png","jpg","jpeg","gif","bmp","webp"],video:["mp4","avi","rmvb","rm","asf","divx","mpg","mpeg","mpe","wmv","mkv","vob"]},de=e=>{if(console.log(e),le.fileType){if(!ne[le.fileType].some((a=>{if(e.includes(a))return!0})))return void _({type:"error",message:"当前类型不支持使用"})}le.multiple?(se.value.push(e),ae.value=se.value):ae.value=e,ue.value=!1},ce=async()=>{!ae.value||le.multiple?(await pe(),ue.value=!0):ae.value=""},pe=async()=>{const e=await I({page:Z.value,pageSize:ee.value,...Y.value});0===e.code&&(re.value=e.data.list,$.value=e.data.total,Z.value=e.data.page,ee.value=e.data.pageSize)};return(l,s)=>{const t=i("VideoPlay"),I=x,le=b,ne=h,me=D,ve=A,ge=w;return o(),u("div",null,[e.multiple?(o(),u("div",F,[(o(!0),u(f,null,C(se.value,((e,a)=>(o(),u("div",{key:a,class:"update-image",style:r({"background-image":"url(".concat(n(V)(e),")"),position:"relative"})},[n(z)(e||"")?(o(),d(I,{key:0,size:32,class:"video video-icon"},{default:c((()=>[p(t)])),_:1})):m("",!0),n(z)(e||"")?(o(),u("video",{key:1,class:"avatar video-avatar video",muted:"",preload:"metadata",onClick:e=>te(a)},[v("source",{src:n(V)(e)+"#t=1"},null,8,N)],8,M)):m("",!0),v("span",{class:"update",style:{position:"absolute"},onClick:e=>te(a)},[p(I,null,{default:c((()=>[p(n(g))])),_:1}),y(" 删除")],8,G)],4)))),128)),!e.maxUpdateCount||e.maxUpdateCount>se.value.length?(o(),u("div",R,[v("span",{class:"update text-gray-600",onClick:ce},[p(I,null,{default:c((()=>[p(n(k))])),_:1}),y(" 上传")])])):m("",!0)])):(o(),u("div",{key:0,class:"update-image",style:r({"background-image":"url(".concat(n(V)(ae.value),")"),position:"relative"})},[n(z)(ae.value||"")?(o(),d(I,{key:0,size:32,class:"video video-icon",style:{}},{default:c((()=>[p(t)])),_:1})):m("",!0),n(z)(ae.value||"")?(o(),u("video",{key:1,class:"avatar video-avatar video",muted:"",preload:"metadata",style:{},onClick:ce},[v("source",{src:n(V)(ae.value)+"#t=1"},null,8,P)])):m("",!0),ae.value?(o(),u("span",{key:2,class:"update",style:{position:"absolute"},onClick:ce},[p(I,null,{default:c((()=>[p(n(g))])),_:1}),y(" 删除")])):(o(),u("span",{key:3,class:"update text-gray-600",onClick:ce},[p(I,null,{default:c((()=>[p(n(k))])),_:1}),y(" 上传")]))],4)),p(ge,{modelValue:ue.value,"onUpdate:modelValue":s[1]||(s[1]=e=>ue.value=e),title:"媒体库",size:"650px"},{default:c((()=>[p(O,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),v("div",X,[p(S,{"image-common":W.value,onOnSuccess:pe},null,8,["image-common"]),p(U,{"image-url":a.value,"file-size":512,"max-w-h":1080,onOnSuccess:pe},null,8,["image-url"]),p(le,{modelValue:Y.value.keyword,"onUpdate:modelValue":s[0]||(s[0]=e=>Y.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),p(ne,{type:"primary",icon:"search",onClick:pe},{default:c((()=>[y("查询 ")])),_:1})]),v("div",q,[(o(!0),u(f,null,C(re.value,((e,a)=>(o(),u("div",{key:a,class:"media-box"},[v("div",H,[(o(),d(me,{key:a,src:n(V)(e.url),fit:"cover",style:{width:"100%",height:"100%"},onClick:a=>de(e.url)},{error:c((()=>[n(z)(e.url||"")?(o(),d(I,{key:0,size:32,class:"video video-icon"},{default:c((()=>[p(t)])),_:1})):m("",!0),n(z)(e.url||"")?(o(),u("video",{key:1,class:"avatar video-avatar video",muted:"",preload:"metadata",onClick:a=>de(e.url)},[v("source",{src:n(V)(e.url)+"#t=1"},null,8,K),y(" 您的浏览器不支持视频播放 ")],8,J)):(o(),u("div",L,[p(I,{class:"lost-image"},{default:c((()=>[p(n(B))])),_:1})]))])),_:2},1032,["src","onClick"]))]),v("div",{class:"img-title",onClick:a=>(async e=>{j.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await T(e)).code&&(_({type:"success",message:"编辑成功!"}),pe())})).catch((()=>{_({type:"info",message:"取消修改"})}))})(e)},E(e.name),9,Q)])))),128))]),p(ve,{"current-page":Z.value,"page-size":ee.value,total:$.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:oe,onSizeChange:ie},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-21073227"]]);export{W as S};
